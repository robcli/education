[
  {
    "objectID": "notebooks/combined.html",
    "href": "notebooks/combined.html",
    "title": "",
    "section": "",
    "text": "import scipy\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport sys\n\nsys.path.insert(1, \"../\")\n\nimport utils.scores as scores\nimport utils.anomaly as anomaly\nimport utils.us_map\n\n\nstates = utils.us_map.main(\"../data/cb_2018_us_state_500k\")\nact_sat_conv = pd.read_excel(\"../data/act_sat_conversion.xlsx\", skiprows=1)\n\n\nplt.plot(act_sat_conv.ACT, act_sat_conv.SAT, marker=\"o\")\nact_sat_reg = scipy.stats.linregress(act_sat_conv.ACT, act_sat_conv.SAT)\nreg_values = anomaly.linear(\n    act_sat_conv.ACT, act_sat_reg.slope, act_sat_reg.intercept)\nplt.plot(act_sat_conv.ACT, reg_values, marker=\"o\", alpha=0.5)\nplt.ylabel(\"SAT Score Equivalent\")\nplt.xlabel(\"ACT Score\")\n\nText(0.5, 0, 'ACT Score')\n\n\n\n\n\n\n\n\n\n\ns1 = scores.SATScores(\"../data/sat/tabn226.40_17_18_19_20.xlsx\")\ns2 = scores.SATScores(\"../data/sat/tabn226.40_18_21_22_23.xlsx\")\ns2.df = s2.df.query(\"year!=2018\")\n\n\npaths = ['../data/act/tabn226.60_2013_2017.xlsx',\n         '../data/act/tabn226.60_2014_2018.xlsx',\n         '../data/act/tabn226.60_2015_2019.xlsx',\n         '../data/act/tabn226.60_2016_2020.xlsx',\n         '../data/act/tabn226.60_2017_2021.xlsx',\n         '../data/act/tabn226.60_2018_2022.xlsx',\n         '../data/act/tabn226.60_2018_2023.xlsx']\n\nobjs = [scores.ACTScores(path) for path in paths]\nobjs[0].df = objs[0].df.query(\"year==2013\")\nobjs[1].df = objs[1].df.query(\"year==2014\")\n\n\ntest_scores = scores.Scores()\n\nfor score in [s1, s2] + objs:\n    test_scores = test_scores.merge(score)\n\ntest_scores.df\n\n\n\n\n\n\n\n\nlocation\nyear\npercent\nsection\nmean\ntest\n\n\n\n\n0\nUnited States\n2017\n47.605306\ntotal\n1060.0\nSAT\n\n\n1\nAlabama\n2017\n5.000000\ntotal\n1165.0\nSAT\n\n\n2\nAlaska\n2017\n38.000000\ntotal\n1080.0\nSAT\n\n\n3\nArizona\n2017\n30.000000\ntotal\n1116.0\nSAT\n\n\n4\nArkansas\n2017\n3.000000\ntotal\n1208.0\nSAT\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n515\nVirginia\n2023\n8.000000\nscience\n24.3\nACT\n\n\n516\nWashington\n2023\n6.000000\nscience\n24.2\nACT\n\n\n517\nWest Virginia\n2023\n26.000000\nscience\n20.1\nACT\n\n\n518\nWisconsin\n2023\n95.000000\nscience\n19.8\nACT\n\n\n519\nWyoming\n2023\n100.000000\nscience\n19.3\nACT\n\n\n\n\n4212 rows × 6 columns\n\n\n\n\nact_scores = test_scores.get_section(\"composite\").df\nact_scores_conv_df = act_scores.assign(SAT_equiv=anomaly.linear(\n    act_scores[\"mean\"], act_sat_reg.slope, act_sat_reg.intercept))\n\n\nsat_scores = test_scores.get_section(\"total\").df\ncombined_scores = (sat_scores.merge(act_scores_conv_df, on=[\"location\", \"year\"])\n                             .rename({\"percent_x\": \"SAT_percent\",\n                                      \"mean_x\": \"SAT_mean\",\n                                      \"percent_y\": \"ACT_percent\"}, axis=1))\ncombined_scores\n\n\n\n\n\n\n\n\nlocation\nyear\nSAT_percent\nsection_x\nSAT_mean\ntest_x\nACT_percent\nsection_y\nmean_y\ntest_y\nSAT_equiv\n\n\n\n\n0\nUnited States\n2017\n47.605306\ntotal\n1060.0\nSAT\n56.334392\ncomposite\n21.0\nACT\n1054.466338\n\n\n1\nAlabama\n2017\n5.000000\ntotal\n1165.0\nSAT\n100.000000\ncomposite\n19.2\nACT\n989.968801\n\n\n2\nAlaska\n2017\n38.000000\ntotal\n1080.0\nSAT\n65.000000\ncomposite\n19.8\nACT\n1011.467980\n\n\n3\nArizona\n2017\n30.000000\ntotal\n1116.0\nSAT\n62.000000\ncomposite\n19.7\nACT\n1007.884784\n\n\n4\nArkansas\n2017\n3.000000\ntotal\n1208.0\nSAT\n100.000000\ncomposite\n19.4\nACT\n997.135194\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n411\nVirginia\n2023\n49.000000\ntotal\n1113.0\nSAT\n8.000000\ncomposite\n24.6\nACT\n1183.461412\n\n\n412\nWashington\n2023\n37.000000\ntotal\n1081.0\nSAT\n6.000000\ncomposite\n24.5\nACT\n1179.878216\n\n\n413\nWest Virginia\n2023\n90.000000\ntotal\n923.0\nSAT\n26.000000\ncomposite\n20.3\nACT\n1029.383963\n\n\n414\nWisconsin\n2023\n2.000000\ntotal\n1236.0\nSAT\n95.000000\ncomposite\n19.4\nACT\n997.135194\n\n\n415\nWyoming\n2023\n1.000000\ntotal\n1200.0\nSAT\n100.000000\ncomposite\n19.0\nACT\n982.802408\n\n\n\n\n416 rows × 11 columns\n\n\n\n\nmajority_mean = np.where(combined_scores[\"ACT_percent\"] &gt; combined_scores[\"SAT_percent\"],\n                         combined_scores[\"SAT_equiv\"],\n                         combined_scores[\"SAT_mean\"])\n\nmajority_percent = np.where(combined_scores[\"ACT_percent\"] &gt; combined_scores[\"SAT_percent\"],\n                            combined_scores[\"ACT_percent\"],\n                            combined_scores[\"SAT_percent\"])\n\ncombined_scores = (combined_scores.assign(mean=majority_mean)\n                                  .assign(percent=majority_percent))\n\ncombined_scores.head()\n\n\n\n\n\n\n\n\nlocation\nyear\nSAT_percent\nsection_x\nSAT_mean\ntest_x\nACT_percent\nsection_y\nmean_y\ntest_y\nSAT_equiv\nmean\npercent\n\n\n\n\n0\nUnited States\n2017\n47.605306\ntotal\n1060.0\nSAT\n56.334392\ncomposite\n21.0\nACT\n1054.466338\n1054.466338\n56.334392\n\n\n1\nAlabama\n2017\n5.000000\ntotal\n1165.0\nSAT\n100.000000\ncomposite\n19.2\nACT\n989.968801\n989.968801\n100.000000\n\n\n2\nAlaska\n2017\n38.000000\ntotal\n1080.0\nSAT\n65.000000\ncomposite\n19.8\nACT\n1011.467980\n1011.467980\n65.000000\n\n\n3\nArizona\n2017\n30.000000\ntotal\n1116.0\nSAT\n62.000000\ncomposite\n19.7\nACT\n1007.884784\n1007.884784\n62.000000\n\n\n4\nArkansas\n2017\n3.000000\ntotal\n1208.0\nSAT\n100.000000\ncomposite\n19.4\nACT\n997.135194\n997.135194\n100.000000\n\n\n\n\n\n\n\n\ndemonstration_locals = [\"Nebraska\",\n                        \"Massachusetts\", \"United States\", \"Florida\"]\n\nsns.lineplot(data=combined_scores.query(\"location in @demonstration_locals\"),\n             x=\"year\",\n             y=\"mean\",\n             hue=\"location\",\n             marker=\"o\")\n\n\n\n\n\n\n\n\n\nstates.merge(combined_scores, left_on=\"NAME\", right_on=\"location\")\\\n    .plot(column=\"mean\",\n          legend=True,\n          cmap=\"inferno\",\n          edgecolor=\"black\",\n          figsize=(8, 8),\n          lw=0.5,\n          legend_kwds={\"label\": \"Mean SAT or ACT converted Score\",\n                       \"shrink\": 0.5})\n\nplt.axis(\"Off\")\nplt.show()\n\n\n\n\n\n\n\n\n\nrankings = combined_scores.pivot_table(\n    index=\"location\", columns=\"year\", values=\"mean\").sort_values(2023, ascending=False).reset_index()\nrankings.columns.name = \"2023 Rankings\"\nrankings.index = rankings.index + 1\nrankings.round(1)\n\n\n\n\n\n\n\n2023 Rankings\nlocation\n2017\n2018\n2019\n2020\n2021\n2022\n2023\n\n\n\n\n1\nOregon\n1108.0\n1117.0\n1112.0\n1104.0\n1040.1\n1143.0\n1125.0\n\n\n2\nVirginia\n1102.0\n1117.0\n1119.0\n1116.0\n1151.0\n1124.0\n1113.0\n\n\n3\nMassachusetts\n1107.0\n1125.0\n1120.0\n1119.0\n1184.0\n1129.0\n1112.0\n\n\n4\nVermont\n1114.0\n1120.0\n1106.0\n1103.0\n1124.0\n1095.0\n1099.0\n\n\n5\nCalifornia\n1055.0\n1076.0\n1065.0\n1049.0\n1057.0\n1115.0\n1083.0\n\n\n6\nAlaska\n1011.5\n1106.0\n1097.0\n1098.0\n1119.0\n1110.0\n1082.0\n\n\n7\nWashington\n1075.0\n1081.0\n1074.0\n1073.0\n1072.0\n1096.0\n1081.0\n\n\n8\nMaine\n1012.0\n1013.0\n1013.0\n995.0\n1099.0\n1081.0\n1080.0\n\n\n9\nPennsylvania\n1071.0\n1086.0\n1082.0\n1078.0\n1123.0\n1091.0\n1078.0\n\n\n10\nNew Jersey\n1056.0\n1094.0\n1090.0\n1081.0\n1125.0\n1079.0\n1066.0\n\n\n11\nSouth Dakota\n1083.1\n1086.7\n1076.0\n1079.5\n1076.0\n1072.4\n1058.0\n\n\n12\nGeorgia\n1050.0\n1064.0\n1058.0\n1053.0\n1086.0\n1060.0\n1054.0\n\n\n13\nIowa\n1086.7\n1083.1\n1076.0\n1058.0\n1072.4\n1068.8\n1047.3\n\n\n14\nMinnesota\n1072.4\n1065.2\n1068.8\n1065.2\n1076.0\n1054.5\n1047.3\n\n\n15\nNew York\n1052.0\n1068.0\n1064.0\n1058.0\n1057.0\n1067.0\n1039.0\n\n\n16\nNew Hampshire\n1052.0\n1063.0\n1059.0\n1055.0\n1065.0\n1050.0\n1035.0\n\n\n17\nSouth Carolina\n972.1\n957.7\n975.6\n961.3\n968.5\n1030.0\n1028.0\n\n\n18\nUnited States\n1054.5\n1068.0\n1059.0\n1051.0\n1060.0\n1050.0\n1028.0\n\n\n19\nUtah\n1029.4\n1033.0\n1029.4\n1025.8\n1040.1\n1015.1\n1015.1\n\n\n20\nMissouri\n1033.0\n1018.6\n1047.3\n1043.7\n1040.1\n1025.8\n1011.5\n\n\n21\nMaryland\n1060.0\n1080.0\n1058.0\n1029.0\n1073.0\n1075.0\n1008.0\n\n\n22\nConnecticut\n1041.0\n1053.0\n1046.0\n1039.0\n1072.0\n1025.0\n1007.0\n\n\n23\nNorth Dakota\n1029.4\n1029.4\n1015.1\n1004.3\n1004.3\n990.0\n1004.3\n\n\n24\nKansas\n1079.5\n1076.0\n1061.6\n1033.0\n1015.1\n1015.1\n997.1\n\n\n25\nWisconsin\n1036.6\n1036.6\n1029.4\n1022.2\n1018.6\n997.1\n997.1\n\n\n26\nColorado\n1047.3\n1025.0\n1024.0\n1012.0\n1072.0\n1021.0\n996.0\n\n\n27\nOhio\n1090.3\n1029.4\n1018.6\n1015.1\n1004.3\n997.1\n990.0\n\n\n28\nNebraska\n1068.8\n1022.2\n1018.6\n1015.1\n1018.6\n997.1\n990.0\n\n\n29\nWyoming\n1025.8\n1018.6\n1011.5\n1007.9\n1011.5\n990.0\n982.8\n\n\n30\nTexas\n1020.0\n1032.0\n1022.0\n1010.0\n1003.0\n1001.0\n978.0\n\n\n31\nMontana\n1029.4\n1018.6\n1011.5\n1015.1\n1033.0\n993.6\n975.6\n\n\n32\nKentucky\n1018.6\n1025.8\n1011.5\n1000.7\n990.0\n968.5\n972.1\n\n\n33\nIndiana\n1074.0\n1086.0\n1080.0\n1074.0\n1095.0\n1073.0\n971.0\n\n\n34\nIllinois\n1068.8\n1019.0\n1013.0\n1007.0\n1007.0\n981.0\n970.0\n\n\n35\nIdaho\n1005.0\n1001.0\n993.0\n984.0\n985.0\n986.0\n970.0\n\n\n36\nDistrict of Columbia\n950.0\n977.0\n975.0\n979.0\n987.0\n985.0\n969.0\n\n\n37\nArkansas\n997.1\n997.1\n993.6\n982.8\n982.8\n975.6\n968.5\n\n\n38\nMichigan\n1005.0\n1011.0\n1003.0\n998.0\n1031.0\n1000.0\n967.0\n\n\n39\nFlorida\n1017.0\n1014.0\n999.0\n992.0\n993.0\n983.0\n966.0\n\n\n40\nNorth Carolina\n986.4\n986.4\n982.8\n975.6\n979.2\n964.9\n964.9\n\n\n41\nTennessee\n1011.5\n1004.3\n997.1\n993.6\n986.4\n968.5\n961.3\n\n\n42\nDelaware\n996.0\n998.0\n985.0\n978.0\n984.0\n968.0\n958.0\n\n\n43\nRhode Island\n1062.0\n1018.0\n995.0\n990.0\n1011.0\n971.0\n958.0\n\n\n44\nLouisiana\n1000.7\n990.0\n975.6\n972.1\n961.3\n950.6\n954.1\n\n\n45\nAlabama\n990.0\n986.4\n979.2\n975.6\n972.1\n947.0\n947.0\n\n\n46\nHawaii\n982.8\n979.2\n982.8\n964.9\n954.1\n975.6\n943.4\n\n\n47\nOklahoma\n997.1\n993.6\n979.2\n972.1\n1007.9\n943.4\n939.8\n\n\n48\nArizona\n1007.9\n990.0\n982.8\n986.4\n1011.5\n961.3\n936.2\n\n\n49\nMississippi\n968.5\n968.5\n961.3\n954.1\n950.6\n939.8\n932.6\n\n\n50\nWest Virginia\n1033.0\n1029.4\n943.0\n936.0\n1007.0\n938.0\n923.0\n\n\n51\nNevada\n939.8\n936.2\n943.4\n943.4\n939.8\n921.9\n918.3\n\n\n52\nNew Mexico\n1007.9\n997.1\n993.6\n993.6\n996.0\n976.0\n901.0\n\n\n\n\n\n\n\n\ncombined_scores.query(\"location == 'North Dakota'\")\n\n\n\n\n\n\n\n\nlocation\nyear\nSAT_percent\nsection_x\nSAT_mean\ntest_x\nACT_percent\nsection_y\nmean_y\ntest_y\nSAT_equiv\nmean\npercent\n\n\n\n\n35\nNorth Dakota\n2017\n2.0\ntotal\n1256.0\nSAT\n98.0\ncomposite\n20.3\nACT\n1029.383963\n1029.383963\n98.0\n\n\n122\nNorth Dakota\n2018\n2.0\ntotal\n1283.0\nSAT\n98.0\ncomposite\n20.3\nACT\n1029.383963\n1029.383963\n98.0\n\n\n123\nNorth Dakota\n2018\n2.0\ntotal\n1283.0\nSAT\n98.0\ncomposite\n20.3\nACT\n1029.383963\n1029.383963\n98.0\n\n\n191\nNorth Dakota\n2019\n2.0\ntotal\n1263.0\nSAT\n96.0\ncomposite\n19.9\nACT\n1015.051177\n1015.051177\n96.0\n\n\n243\nNorth Dakota\n2020\n2.0\ntotal\n1231.0\nSAT\n94.0\ncomposite\n19.6\nACT\n1004.301587\n1004.301587\n94.0\n\n\n295\nNorth Dakota\n2021\n1.0\ntotal\n1258.0\nSAT\n100.0\ncomposite\n19.6\nACT\n1004.301587\n1004.301587\n100.0\n\n\n347\nNorth Dakota\n2022\n1.0\ntotal\n1212.0\nSAT\n96.0\ncomposite\n19.2\nACT\n989.968801\n989.968801\n96.0\n\n\n399\nNorth Dakota\n2023\n1.0\ntotal\n1287.0\nSAT\n89.0\ncomposite\n19.6\nACT\n1004.301587\n1004.301587\n89.0\n\n\n\n\n\n\n\n\nanomaly.anomaly(combined_scores, separate_years=False)\ncombined_corrected_scores = anomaly.anomaly(\n    combined_scores, separate_years=True, suppress=True)\ncombined_corrected_scores = combined_corrected_scores.assign(\n    anom_c=combined_corrected_scores[\"mean\"]-combined_corrected_scores[\"lin_pred\"])\n\n\n\n\n\n\n\n\n\nsns.lineplot(data=combined_corrected_scores.query(\"location in @demonstration_locals\"),\n             x=\"year\",\n             y=\"anom_c\",\n             marker=\"o\",\n             hue=\"location\")\n\n\n\n\n\n\n\n\n\nrankings = combined_corrected_scores.pivot_table(\n    index=\"location\", columns=\"year\", values=\"anom_c\").sort_values(2023, ascending=False).reset_index()\nrankings.columns.name = \"2023 Rankings\"\nrankings.index = rankings.index + 1\nrankings.round(1)\n\n\n\n\n\n\n\n2023 Rankings\nlocation\n2017\n2018\n2019\n2020\n2021\n2022\n2023\n\n\n\n\n1\nMassachusetts\n61.7\n77.9\n81.8\n86.5\n103.4\n75.0\n67.4\n\n\n2\nVirginia\n41.5\n48.2\n56.4\n56.1\n80.9\n56.4\n52.1\n\n\n3\nNew Hampshire\n34.3\n44.8\n47.0\n46.3\n39.7\n46.7\n41.3\n\n\n4\nUtah\n17.2\n22.0\n26.7\n30.0\n37.3\n31.2\n37.7\n\n\n5\nConnecticut\n28.8\n42.0\n43.3\n43.2\n43.7\n37.3\n35.7\n\n\n6\nNew Jersey\n2.4\n50.5\n53.6\n52.2\n65.4\n40.6\n35.6\n\n\n7\nVermont\n46.6\n44.0\n39.7\n39.4\n53.9\n27.4\n29.9\n\n\n8\nWisconsin\n24.3\n25.6\n26.7\n26.4\n30.7\n17.2\n29.9\n\n\n9\nWyoming\n13.6\n7.7\n8.8\n12.0\n16.1\n23.7\n25.8\n\n\n10\nMinnesota\n60.2\n52.4\n56.8\n54.7\n34.3\n27.8\n25.1\n\n\n11\nNorth Dakota\n14.4\n14.8\n4.9\n-2.5\n22.3\n15.9\n24.9\n\n\n12\nNebraska\n34.5\n11.3\n16.0\n19.2\n15.8\n19.2\n24.8\n\n\n13\nColorado\n35.1\n14.0\n21.3\n16.2\n24.3\n23.5\n18.6\n\n\n14\nSouth Dakota\n43.3\n34.2\n26.5\n28.8\n26.8\n24.3\n17.5\n\n\n15\nPennsylvania\n10.5\n20.8\n23.2\n21.7\n49.9\n23.4\n15.0\n\n\n16\nKentucky\n6.4\n14.8\n8.8\n4.9\n8.0\n-5.6\n15.0\n\n\n17\nMontana\n17.2\n7.7\n8.8\n19.2\n6.2\n15.6\n14.5\n\n\n18\nIndiana\n10.7\n15.4\n13.7\n12.2\n27.9\n5.4\n14.0\n\n\n19\nOregon\n17.2\n12.0\n17.6\n18.5\n-61.3\n24.7\n13.2\n\n\n20\nDistrict of Columbia\n-76.0\n-48.4\n-38.9\n-16.8\n-9.9\n18.7\n12.0\n\n\n21\nIllinois\n46.9\n6.2\n10.3\n7.5\n-4.8\n8.9\n4.8\n\n\n22\nNew York\n-5.7\n19.1\n22.0\n23.7\n7.8\n20.8\n4.6\n\n\n23\nTennessee\n-0.8\n-6.7\n-5.5\n-2.3\n4.4\n2.2\n4.3\n\n\n24\nMichigan\n-7.2\n0.0\n0.3\n2.2\n1.2\n2.5\n3.9\n\n\n25\nArkansas\n-15.1\n-13.8\n-9.1\n-13.0\n-0.6\n-4.3\n3.3\n\n\n26\nIdaho\n-16.9\n-10.0\n-9.7\n-11.8\n-11.9\n13.9\n2.8\n\n\n27\nGeorgia\n-16.0\n-1.2\n1.0\n-1.4\n15.9\n4.1\n1.2\n\n\n28\nLouisiana\n-11.5\n-21.0\n-27.0\n-23.8\n-23.6\n-15.7\n-2.9\n\n\n29\nMaine\n-7.1\n0.2\n8.5\n-4.5\n11.0\n3.6\n-3.3\n\n\n30\nOhio\n43.6\n18.4\n16.0\n19.2\n-0.1\n-4.2\n-3.7\n\n\n31\nWashington\n13.1\n14.0\n15.2\n20.4\n-19.0\n-2.8\n-4.4\n\n\n32\nMaryland\n5.0\n25.7\n21.6\n11.2\n11.9\n19.1\n-8.1\n\n\n33\nRhode Island\n9.8\n1.6\n-7.7\n-5.8\n-18.8\n-8.9\n-9.2\n\n\n34\nDelaware\n-16.2\n-13.0\n-17.7\n-17.8\n-3.9\n-8.0\n-9.2\n\n\n35\nAlabama\n-22.3\n-24.6\n-23.4\n-20.2\n-9.9\n-19.3\n-10.1\n\n\n36\nFlorida\n-18.7\n-2.4\n-3.7\n-3.8\n-17.3\n-8.6\n-11.4\n\n\n37\nNorth Carolina\n-25.8\n-24.6\n-19.9\n-20.2\n-14.7\n-24.8\n-12.5\n\n\n38\nKansas\n30.1\n12.6\n6.5\n4.2\n1.7\n-3.8\n-12.9\n\n\n39\nMissouri\n20.7\n7.7\n10.9\n7.6\n2.9\n-6.7\n-14.8\n\n\n40\nIowa\n29.0\n14.3\n9.6\n3.6\n11.2\n3.1\n-15.7\n\n\n41\nOklahoma\n-15.1\n-17.4\n-23.4\n-23.8\n-36.8\n-34.6\n-17.2\n\n\n42\nAlaska\n-49.0\n-8.0\n-16.1\n-13.2\n22.0\n-0.5\n-17.6\n\n\n43\nMississippi\n-43.8\n-42.5\n-41.4\n-41.7\n-31.4\n-26.5\n-24.4\n\n\n44\nArizona\n-56.8\n-82.5\n-70.4\n-62.6\n-67.6\n-75.1\n-24.9\n\n\n45\nCalifornia\n-22.1\n-7.3\n-6.9\n-7.3\n-38.5\n-5.2\n-26.8\n\n\n46\nUnited States\n-18.0\n-18.3\n-17.8\n-17.7\n-11.1\n-20.8\n-28.4\n\n\n47\nSouth Carolina\n-40.2\n-53.2\n-68.2\n-78.5\n-88.2\n-31.8\n-30.9\n\n\n48\nTexas\n-44.6\n-40.4\n-40.6\n-35.3\n-40.2\n-35.4\n-38.1\n\n\n49\nNevada\n-72.4\n-74.7\n-59.3\n-52.5\n-42.1\n-44.4\n-38.7\n\n\n50\nWest Virginia\n-22.0\n-44.8\n-61.5\n-63.5\n-57.1\n-59.5\n-54.4\n\n\n51\nNew Mexico\n-51.2\n-73.5\n-78.4\n-82.8\n-90.5\n-103.3\n-68.2\n\n\n52\nHawaii\n-43.2\n-51.6\n-57.3\n-63.9\n-77.1\n-82.2\n-87.0\n\n\n\n\n\n\n\n\nanomaly.anomaly(combined_scores, separate_years=True)\n\n\n\n\n\n\n\n\nlocation\nyear\nSAT_percent\nsection_x\nSAT_mean\ntest_x\nACT_percent\nsection_y\nmean_y\ntest_y\nSAT_equiv\nmean\npercent\nlin_pred\nplaw_pred\n\n\n\n\n0\nUnited States\n2017\n47.605306\ntotal\n1060.0\nSAT\n56.334392\ncomposite\n21.0\nACT\n1054.466338\n1054.466338\n56.334392\n1072.451745\n1073.863725\n\n\n1\nAlabama\n2017\n5.000000\ntotal\n1165.0\nSAT\n100.000000\ncomposite\n19.2\nACT\n989.968801\n989.968801\n100.000000\n1012.231550\n1013.888680\n\n\n2\nAlaska\n2017\n38.000000\ntotal\n1080.0\nSAT\n65.000000\ncomposite\n19.8\nACT\n1011.467980\n1011.467980\n65.000000\n1060.500816\n1058.586028\n\n\n3\nArizona\n2017\n30.000000\ntotal\n1116.0\nSAT\n62.000000\ncomposite\n19.7\nACT\n1007.884784\n1007.884784\n62.000000\n1064.638182\n1063.607301\n\n\n4\nArkansas\n2017\n3.000000\ntotal\n1208.0\nSAT\n100.000000\ncomposite\n19.4\nACT\n997.135194\n997.135194\n100.000000\n1012.231550\n1013.888680\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n411\nVirginia\n2023\n49.000000\ntotal\n1113.0\nSAT\n8.000000\ncomposite\n24.6\nACT\n1183.461412\n1113.000000\n49.000000\n1060.918986\n1049.645199\n\n\n412\nWashington\n2023\n37.000000\ntotal\n1081.0\nSAT\n6.000000\ncomposite\n24.5\nACT\n1179.878216\n1081.000000\n37.000000\n1085.364376\n1084.640963\n\n\n413\nWest Virginia\n2023\n90.000000\ntotal\n923.0\nSAT\n26.000000\ncomposite\n20.3\nACT\n1029.383963\n923.000000\n90.000000\n977.397235\n977.718254\n\n\n414\nWisconsin\n2023\n2.000000\ntotal\n1236.0\nSAT\n95.000000\ncomposite\n19.4\nACT\n997.135194\n997.135194\n95.000000\n967.211656\n971.565720\n\n\n415\nWyoming\n2023\n1.000000\ntotal\n1200.0\nSAT\n100.000000\ncomposite\n19.0\nACT\n982.802408\n982.802408\n100.000000\n957.026076\n965.764634\n\n\n\n\n416 rows × 15 columns"
  },
  {
    "objectID": "notebooks/naep.html",
    "href": "notebooks/naep.html",
    "title": "",
    "section": "",
    "text": "import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport sys\n\nsys.path.insert(1, \"../\")\n\n\nimport utils.us_map\nimport utils.scores as score\n\nstates = utils.us_map.main(\"../data/cb_2018_us_state_500k\")\n\n\npaths = [\"../data/naep/NDECoreExcel_Reading, Grade 8, All students_20250815065213.xlsx\",\n         \"../data/naep/NDECoreExcel_Reading, Grade 4, All students_20250815065450.xlsx\",\n         \"../data/naep/NDECoreExcel_Mathematics, Grade 8, All students_20250815065004.xlsx\",\n         \"../data/naep/NDECoreExcel_Mathematics, Grade 4, All students_20250815065347.xlsx\"]\n\nnaep_scores = score.Scores()\nfor path in paths:\n    naep_scores = naep_scores.merge(score.NAEPScores(path))\n\nnaep_scores.df\n\n\n\n\n\n\n\n\nyear\nlocation\nmean\nsection\n\n\n\n\n0\n2024\nNational\n258.049834\nReading_8\n\n\n1\n2024\nAlabama\n249.600097\nReading_8\n\n\n2\n2024\nAlaska\n246.448912\nReading_8\n\n\n3\n2024\nArizona\n254.343066\nReading_8\n\n\n4\n2024\nArkansas\n254.774995\nReading_8\n\n\n...\n...\n...\n...\n...\n\n\n319\n2013\nVirginia\n246.177457\nMathematics_4\n\n\n320\n2013\nWashington\n246.288338\nMathematics_4\n\n\n321\n2013\nWest Virginia\n237.440633\nMathematics_4\n\n\n322\n2013\nWisconsin\n244.706292\nMathematics_4\n\n\n323\n2013\nWyoming\n246.522401\nMathematics_4\n\n\n\n\n1284 rows × 4 columns\n\n\n\n\nfig, axes = plt.subplots(nrows=2, ncols=2, figsize=(8, 8), layout=\"tight\")\naxes = axes.flatten()\n[ax.set_axis_off() for ax in axes]\nmin_value = naep_scores.get_year(2024).df[\"mean\"].min()\nmax_value = naep_scores.get_year(2024).df[\"mean\"].max()\n\nfor section, ax in zip(sorted(naep_scores.df[\"section\"].unique()), axes):\n    df = naep_scores.get_year(2024).get_section(section).df\n    label = \"NAEP \" + \" \".join(section.split(\"_\")) + \"th grade\"\n    ax.set_title(f\"{label}\")\n    map = (states.merge(df,\n                        right_on=\"location\", left_on=\"NAME\")\n           .plot(column=\"mean\",\n                 cmap=\"crest\",\n                 legend=True,\n                 edgecolor=\"black\",\n                 lw=0.25,\n                 legend_kwds={\"label\": \"Score\",\n                              \"shrink\": 0.75,\n                              \"orientation\": \"horizontal\",\n                              \"pad\": 0.01\n                              },\n                 ax=ax))\n\nfig.suptitle(\"NAEP Scores by Section and Grade\", y=0.88)\nplt.show()\n\n\n\n\n\n\n\n\n\ncombined_scores_df = naep_scores.df.groupby(\n    [\"year\", \"location\"]).agg(total=(\"mean\", \"sum\")).reset_index()\n\n(states.merge(combined_scores_df.query(\"year==2024\"),\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"total\",\n       cmap=\"crest\",\n       legend=True,\n       edgecolor=\"black\",\n       lw=0.25,\n       legend_kwds={\"label\": \"NAEP Combined Scores\",\n                    \"shrink\": 0.75,\n                    \"orientation\": \"horizontal\",\n                    \"pad\": 0.05\n                    })\n )\n\nplt.axis(\"off\")\nplt.show()\n\n\n\n\n\n\n\n\n\nnon_states = [\"DoDEA\", \"Puerto Rico\", \"District of Columbia\", \"National\"]\n\nrankings = (combined_scores_df.query(\"location not in @non_states\")\n            .pivot_table(index=\"location\", columns=\"year\", values=\"total\")\n            .sort_values(2024, ascending=False)\n            .reset_index()\n            )\n\nrankings.columns.name = \"2024 Rankings\"\nrankings.index = rankings.index + 1\nrankings.round(1)\n\n\n\n\n\n\n\n2024 Rankings\nlocation\n2013\n2015\n2017\n2019\n2022\n2024\n\n\n\n\n1\nMassachusetts\n1063.0\n1057.2\n1059.6\n1046.0\n1020.9\n1022.7\n\n\n2\nNew Jersey\n1048.0\n1039.1\n1047.5\n1035.3\n1012.6\n1009.4\n\n\n3\nNew Hampshire\n1055.0\n1050.3\n1042.3\n1024.0\n1003.7\n1006.7\n\n\n4\nUtah\n1020.0\n1024.3\n1023.2\n1021.3\n1008.1\n1003.9\n\n\n5\nWyoming\n1031.5\n1030.4\n1032.4\n1023.5\n1009.6\n1003.6\n\n\n6\nColorado\n1034.3\n1019.2\n1022.0\n1018.7\n997.6\n1002.7\n\n\n7\nIndiana\n1029.0\n1030.4\n1032.7\n1018.3\n995.7\n1000.3\n\n\n8\nConnecticut\n1032.7\n1026.1\n1024.3\n1023.5\n995.8\n998.0\n\n\n9\nWisconsin\n1021.8\n1025.3\n1017.5\n1017.4\n1001.0\n997.3\n\n\n10\nMinnesota\n1046.1\n1037.3\n1035.9\n1025.4\n995.0\n997.3\n\n\n11\nMontana\n1027.7\n1023.5\n1015.9\n1011.6\n995.9\n995.3\n\n\n12\nSouth Dakota\n1014.3\n1011.9\n1017.1\n1013.2\n1000.4\n994.9\n\n\n13\nOhio\n1028.1\n1019.5\n1022.4\n1015.9\n994.4\n994.6\n\n\n14\nNorth Dakota\n1028.8\n1024.6\n1019.0\n1012.9\n994.1\n993.9\n\n\n15\nIdaho\n1016.7\n1012.8\n1016.8\n1016.8\n996.4\n992.9\n\n\n16\nTennessee\n1002.6\n1002.3\n996.5\n1001.3\n979.9\n989.6\n\n\n17\nIllinois\n1009.3\n1008.1\n1007.0\n1002.8\n991.9\n989.4\n\n\n18\nPennsylvania\n1032.1\n1022.4\n1022.5\n1016.4\n989.8\n989.3\n\n\n19\nIowa\n1023.7\n1021.6\n1018.8\n1005.2\n994.8\n987.2\n\n\n20\nWashington\n1033.3\n1024.6\n1025.6\n1011.3\n989.2\n986.2\n\n\n21\nNebraska\n1020.7\n1026.4\n1026.6\n1015.1\n998.9\n985.9\n\n\n22\nKentucky\n1016.2\n1015.5\n1006.1\n1001.3\n978.3\n984.7\n\n\n23\nVirginia\n1030.5\n1030.1\n1033.5\n1019.4\n989.1\n983.2\n\n\n24\nNorth Carolina\n1017.2\n1011.5\n1009.5\n1008.9\n981.9\n982.9\n\n\n25\nHawaii\n999.5\n989.7\n992.6\n989.6\n984.4\n982.4\n\n\n26\nFlorida\n1015.8\n1008.6\n1020.3\n1012.5\n996.4\n981.7\n\n\n27\nRhode Island\n1015.0\n1010.0\n1003.9\n997.4\n981.1\n981.2\n\n\n28\nVermont\n1045.6\n1037.7\n1028.4\n1015.8\n991.5\n980.4\n\n\n29\nMississippi\n963.9\n970.9\n977.2\n990.2\n969.2\n980.2\n\n\n30\nKansas\n1026.0\n1012.8\n1017.3\n1003.6\n977.9\n979.9\n\n\n31\nGeorgia\n1005.7\n999.4\n1003.4\n997.5\n982.1\n978.5\n\n\n32\nNew York\n1012.3\n1002.8\n1003.3\n998.5\n976.6\n976.5\n\n\n33\nMaryland\n1037.7\n1013.5\n1013.8\n1002.9\n969.1\n976.3\n\n\n34\nSouth Carolina\n991.5\n991.2\n981.6\n988.1\n973.5\n974.2\n\n\n35\nTexas\n1010.7\n1006.4\n998.5\n995.1\n980.6\n974.1\n\n\n36\nLouisiana\n971.9\n974.4\n963.8\n970.2\n963.1\n973.8\n\n\n37\nMissouri\n1012.1\n1009.4\n1008.8\n1000.5\n975.5\n972.5\n\n\n38\nMaine\n1028.6\n1019.2\n1014.2\n1009.5\n975.1\n970.4\n\n\n39\nMichigan\n1000.3\n994.7\n998.3\n997.3\n975.1\n969.4\n\n\n40\nCalifornia\n983.6\n978.5\n986.8\n985.6\n973.3\n967.9\n\n\n41\nNevada\n990.0\n982.8\n981.7\n985.1\n969.0\n964.8\n\n\n42\nArizona\n993.6\n998.6\n995.1\n992.9\n976.7\n964.5\n\n\n43\nArkansas\n998.3\n987.1\n983.7\n981.5\n962.0\n961.0\n\n\n44\nAlabama\n978.1\n973.3\n974.6\n963.5\n958.6\n960.9\n\n\n45\nOregon\n1011.0\n1008.5\n999.1\n997.3\n965.8\n958.4\n\n\n46\nDelaware\n1017.2\n1004.8\n998.7\n993.4\n951.1\n955.2\n\n\n47\nOklahoma\n993.3\n998.9\n989.8\n988.2\n952.8\n953.1\n\n\n48\nWest Virginia\n983.9\n983.1\n985.5\n972.7\n941.1\n945.5\n\n\n49\nAlaska\n988.3\n989.9\n972.2\n963.4\n952.2\n937.9\n\n\n50\nNew Mexico\n967.2\n962.5\n962.4\n959.1\n930.1\n925.8"
  },
  {
    "objectID": "final.html",
    "href": "final.html",
    "title": "Educational Trends in America",
    "section": "",
    "text": "I was reading by this article from U.S. News & World Report, which makes sweeping claims about Florida being the top state in both education and the economy. Adding to the hype were two celebratory press releases from Governor Ron DeSantis, here and here, touting supposed gains in Florida’s education system.\nHowever, these claims rest almost entirely on state controlled assessments, where the state determines the content and standards. This raises valid concerns about the objectivity of the data being reported. A more reliable approach would be to examine trends in national standardized assessments, which offer consistent, independent measures across all states. When doing so, a very different picture emerges: Florida’s educational performance has, like much of the nation, declined over time. The trends are stark and paint a clear message to our nation. Rather than cling onto rankings, we need to think more deeply about how we can invest in our future’s generation."
  },
  {
    "objectID": "final.html#acknowledgements",
    "href": "final.html#acknowledgements",
    "title": "Educational Trends in America",
    "section": "Acknowledgements",
    "text": "Acknowledgements\nThank you to Oscar for sharing code on how to create maps of the US. Thank you to NCES and NAEP for developing the data used for the analysis."
  },
  {
    "objectID": "notebooks/sat.html",
    "href": "notebooks/sat.html",
    "title": "",
    "section": "",
    "text": "import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport sys\n\nsys.path.insert(1, \"../\")\n\n\nimport utils.us_map\nimport utils.anomaly as anomaly\nimport utils.scores as scores\nstates = utils.us_map.main(\"../data/cb_2018_us_state_500k\")\n\n\ns1 = scores.SATScores(\"../data/sat/tabn226.40_17_18_19_20.xlsx\")\ns2 = scores.SATScores(\"../data/sat/tabn226.40_18_21_22_23.xlsx\")\ns2.df = s2.df.query(\"year!=2018\")\n\nsat_scores = scores.Scores()\nsat_scores = sat_scores.merge(s1).merge(s2)\nsat_scores.df.head()\n\n\n\n\n\n\n\n\nlocation\nyear\npercent\nsection\nmean\ntest\n\n\n\n\n0\nUnited States\n2017\n47.605306\ntotal\n1060\nSAT\n\n\n1\nAlabama\n2017\n5.000000\ntotal\n1165\nSAT\n\n\n2\nAlaska\n2017\n38.000000\ntotal\n1080\nSAT\n\n\n3\nArizona\n2017\n30.000000\ntotal\n1116\nSAT\n\n\n4\nArkansas\n2017\n3.000000\ntotal\n1208\nSAT\n\n\n\n\n\n\n\n\n(states.merge(sat_scores.get_section(\"total\").get_year(2023).df,\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"mean\",\n       legend=True,\n       cmap=\"inferno\",\n       edgecolor=\"black\",\n       figsize=(8, 8),\n       lw=0.5,\n       legend_kwds={\"label\": \"Average SAT Score\", \"shrink\": 0.5}))\n\nplt.axis(\"off\")\nplt.title(\"Average SAT Score by State (2023)\")\nplt.show()\n\n\n\n\n\n\n\n\n\ndemonstration_locals = [\"Nebraska\",\n                        \"Massachusetts\", \"Florida\", \"United States\"]\n\nsat_scores.plot(demonstration_locals, section=\"total\")\nplt.legend(loc=\"center left\", bbox_to_anchor=(1, 0.5))\nplt.ylabel(\"Average SAT Score\")\nplt.xticks(range(sat_scores.df[\"year\"].min(), sat_scores.df[\"year\"].max()+1))\nplt.show()\n\n\n\n\n\n\n\n\n\n(states.merge(sat_scores.get_section(\"total\").get_year(2023).df,\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"percent\",\n       legend=True,\n       edgecolor=\"black\",\n       figsize=(8, 8),\n       lw=0.5,\n       legend_kwds={\"label\": \"Percentage of College Bound Seniors\", \"shrink\": 0.5}))\n\nplt.axis(\"off\")\nplt.title(\"Percentage of High Schoolers Participating in SAT by State (2023)\")\nplt.show()\n\n\n\n\n\n\n\n\n\nscores = sat_scores.get_section(\"total\").df\n\nanomaly.anomaly(scores, separate_years=False)\nplt.title(\"Average SAT score by State vs. Percentage Participation Rates\")\n\nsat_corrected_scores = anomaly.anomaly(\n    scores, separate_years=True, suppress=True)\nplaw_scores = sat_corrected_scores.assign(\n    anom_c=sat_corrected_scores[\"mean\"]-sat_corrected_scores[\"plaw_pred\"])\n\n\n\n\n\n\n\n\n\n(states.merge(plaw_scores.query(\"year==2023\"),\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"anom_c\",\n       legend=True,\n       cmap=\"inferno\",\n       edgecolor=\"black\",\n       figsize=(8, 8),\n       lw=0.5,\n       legend_kwds={\"label\": \"Percentage Corrected SAT Performance\", \"shrink\": 0.5}))\n\nplt.axis(\"off\")\nplt.title(\"SAT Performance by State Corrected for Percentage Participation (2023)\")\nplt.show()\n\n\n\n\n\n\n\n\n\nsns.lineplot(data=plaw_scores.query(\"location in @demonstration_locals\"),\n             x=\"year\",\n             y=\"anom_c\",\n             hue=\"location\",\n             marker=\"o\")\n\nplt.legend(loc=\"center left\", bbox_to_anchor=(1, 0.5))\nplt.ylabel(\"SAT Performance Corrected for Percentage Participation\")\nplt.xticks(range(sat_scores.df[\"year\"].min(), sat_scores.df[\"year\"].max()+1))\nplt.show()\n\n\n\n\n\n\n\n\n\nrankings = plaw_scores.pivot_table(index=\"location\", columns=\"year\", values=\"anom_c\").sort_values(\n    2023, ascending=False).reset_index()\nrankings.columns.name = \"2023 Rankings\"\nrankings.index = rankings.index + 1\nrankings.round(1)\n\n\n\n\n\n\n\n2023 Rankings\nlocation\n2017\n2018\n2019\n2020\n2021\n2022\n2023\n\n\n\n\n1\nMassachusetts\n62.1\n72.9\n78.6\n82.9\n106.1\n83.9\n85.6\n\n\n2\nVirginia\n48.5\n55.8\n67.5\n69.2\n81.6\n72.2\n78.8\n\n\n3\nArizona\n18.8\n38.9\n36.0\n49.7\n50.1\n44.2\n68.9\n\n\n4\nVermont\n56.0\n55.4\n52.8\n54.6\n54.6\n43.2\n60.4\n\n\n5\nNorth Carolina\n11.7\n21.6\n31.7\n33.4\n54.0\n55.2\n55.4\n\n\n6\nHawaii\n22.2\n26.9\n35.1\n35.6\n53.7\n50.2\n54.2\n\n\n7\nOregon\n31.3\n36.1\n43.7\n44.6\n8.8\n51.7\n53.4\n\n\n8\nNew Jersey\n6.5\n43.3\n49.3\n46.2\n62.7\n40.6\n45.5\n\n\n9\nPennsylvania\n17.5\n26.4\n32.2\n32.8\n51.3\n39.2\n42.8\n\n\n10\nMontana\n33.6\n23.6\n23.5\n36.9\n55.6\n45.7\n34.3\n\n\n11\nMaine\n-20.8\n-27.3\n-17.0\n-30.8\n13.7\n23.7\n32.6\n\n\n12\nWashington\n20.6\n20.6\n24.2\n29.3\n-16.6\n23.8\n32.3\n\n\n13\nKansas\n40.3\n32.3\n11.8\n35.8\n27.2\n16.0\n32.2\n\n\n14\nNorth Dakota\n-9.0\n4.3\n-14.1\n-12.0\n5.9\n-50.6\n31.6\n\n\n15\nNew Hampshire\n19.8\n21.0\n26.7\n26.6\n20.2\n23.8\n27.0\n\n\n16\nUtah\n-0.3\n-2.7\n0.8\n-14.4\n-14.1\n11.0\n26.2\n\n\n17\nGeorgia\n-7.1\n4.4\n9.0\n8.6\n16.6\n14.0\n23.9\n\n\n18\nWisconsin\n52.7\n42.4\n34.1\n24.6\n-37.1\n30.0\n23.2\n\n\n19\nAlaska\n-3.7\n18.8\n15.8\n21.7\n23.0\n27.3\n22.2\n\n\n20\nTennessee\n22.5\n24.5\n28.1\n17.5\n39.5\n29.7\n19.4\n\n\n21\nNevada\n10.5\n16.2\n31.1\n31.6\n14.5\n11.7\n17.8\n\n\n22\nNew York\n0.1\n15.2\n21.2\n21.3\n0.9\n25.3\n16.9\n\n\n23\nCalifornia\n-9.9\n7.8\n9.1\n3.8\n-37.0\n21.3\n13.6\n\n\n24\nMinnesota\n56.7\n65.3\n54.8\n55.8\n47.2\n26.2\n12.5\n\n\n25\nLouisiana\n-21.7\n-22.7\n-14.2\n-18.0\n-7.0\n-27.8\n5.5\n\n\n26\nConnecticut\n11.0\n13.2\n16.6\n14.2\n26.0\n3.4\n5.3\n\n\n27\nMissouri\n32.7\n29.3\n6.8\n10.8\n3.2\n1.2\n2.5\n\n\n28\nNebraska\n14.7\n0.4\n11.1\n10.6\n30.2\n0.0\n-3.4\n\n\n29\nUnited States\n-10.9\n-1.8\n0.6\n0.2\n-10.2\n-3.5\n-3.9\n\n\n30\nKentucky\n27.3\n15.3\n2.8\n5.8\n3.2\n-3.0\n-4.8\n\n\n31\nIowa\n10.0\n13.4\n-4.9\n1.6\n27.2\n-2.8\n-4.8\n\n\n32\nSouth Carolina\n-4.2\n-3.2\n-21.5\n-18.4\n-26.3\n-18.8\n-5.1\n\n\n33\nMaryland\n9.8\n25.0\n17.3\n-2.2\n9.8\n29.0\n-7.2\n\n\n34\nColorado\n44.4\n-14.8\n-5.4\n-12.8\n16.7\n-3.4\n-7.3\n\n\n35\nArkansas\n-30.3\n-49.2\n-61.1\n-44.2\n-21.8\n-31.0\n-20.8\n\n\n36\nIndiana\n18.7\n24.0\n26.8\n26.4\n27.8\n21.2\n-27.1\n\n\n37\nAlabama\n-40.5\n-40.5\n-48.9\n-41.5\n-36.0\n-36.7\n-27.5\n\n\n38\nDistrict of Columbia\n-85.7\n-67.4\n-57.9\n-45.8\n-47.3\n-31.0\n-29.1\n\n\n39\nIllinois\n-53.9\n-21.3\n-16.4\n-18.8\n-32.5\n-36.5\n-30.1\n\n\n40\nIdaho\n-28.9\n-38.8\n-36.4\n-40.8\n-49.3\n-31.5\n-30.6\n\n\n41\nMichigan\n-25.0\n-28.8\n-26.4\n-26.8\n-15.7\n-24.4\n-32.6\n\n\n42\nTexas\n-36.2\n-30.9\n-29.5\n-30.8\n-50.0\n-36.7\n-37.2\n\n\n43\nFlorida\n-23.1\n-27.5\n-30.4\n-32.8\n-45.9\n-39.7\n-37.3\n\n\n44\nRhode Island\n13.3\n-23.5\n-34.4\n-34.8\n-35.7\n-48.5\n-42.6\n\n\n45\nDelaware\n-34.0\n-41.8\n-44.4\n-46.8\n-47.4\n-50.5\n-42.6\n\n\n46\nOhio\n-2.3\n-39.4\n-31.1\n-36.8\n-68.1\n-48.7\n-43.1\n\n\n47\nSouth Dakota\n-22.3\n-10.6\n19.1\n-0.4\n-37.1\n-3.0\n-47.4\n\n\n48\nWyoming\n-8.3\n5.4\n-10.9\n-23.0\n17.2\n22.0\n-55.4\n\n\n49\nMississippi\n-23.0\n-15.6\n-11.9\n-15.4\n-50.1\n-36.6\n-71.4\n\n\n50\nWest Virginia\n-56.0\n-113.2\n-87.0\n-89.8\n-58.2\n-86.4\n-80.3\n\n\n51\nNew Mexico\n-18.6\n-52.6\n-58.4\n-57.3\n-87.7\n-82.5\n-100.2\n\n\n52\nOklahoma\n-137.4\n-126.3\n-156.0\n-138.5\n-118.4\n-153.6\n-134.1\n\n\n\n\n\n\n\n\nanomaly.anomaly(scores, separate_years=True)\n\n\n\n\n\n\n\n\nlocation\nyear\npercent\nsection\nmean\ntest\nlin_pred\nplaw_pred\n\n\n\n\n0\nUnited States\n2017\n47.605306\ntotal\n1060\nSAT\n1106.840206\n1070.928065\n\n\n1\nAlabama\n2017\n5.000000\ntotal\n1165\nSAT\n1204.540651\n1205.521462\n\n\n2\nAlaska\n2017\n38.000000\ntotal\n1080\nSAT\n1128.866633\n1083.682185\n\n\n3\nArizona\n2017\n30.000000\ntotal\n1116\nSAT\n1147.211849\n1097.223848\n\n\n4\nArkansas\n2017\n3.000000\ntotal\n1208\nSAT\n1209.126956\n1238.310733\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n203\nVirginia\n2023\n49.000000\ntotal\n1113\nSAT\n1072.866587\n1034.173581\n\n\n204\nWashington\n2023\n37.000000\ntotal\n1081\nSAT\n1103.040438\n1048.744977\n\n\n205\nWest Virginia\n2023\n90.000000\ntotal\n923\nSAT\n969.772593\n1003.324616\n\n\n206\nWisconsin\n2023\n2.000000\ntotal\n1236\nSAT\n1191.047506\n1212.793461\n\n\n207\nWyoming\n2023\n1.000000\ntotal\n1200\nSAT\n1193.561994\n1255.396588\n\n\n\n\n364 rows × 8 columns"
  },
  {
    "objectID": "notebooks/act.html",
    "href": "notebooks/act.html",
    "title": "Appedix",
    "section": "",
    "text": "import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport sys\n\nsys.path.insert(1, \"../\")\n\n\nimport utils.us_map\nimport utils.anomaly as anomaly\nimport utils.scores as scores\nstates = utils.us_map.main(\"../data/cb_2018_us_state_500k\")\n\n\npaths = ['../data/act/tabn226.60_2013_2017.xlsx',\n         '../data/act/tabn226.60_2014_2018.xlsx',\n         '../data/act/tabn226.60_2015_2019.xlsx',\n         '../data/act/tabn226.60_2016_2020.xlsx',\n         '../data/act/tabn226.60_2017_2021.xlsx',\n         '../data/act/tabn226.60_2018_2022.xlsx',\n         '../data/act/tabn226.60_2018_2023.xlsx']\n\n\nobjs = [scores.ACTScores(path) for path in paths]\nobjs[0].df = objs[0].df.query(\"year==2013\")\nobjs[1].df = objs[1].df.query(\"year==2014\")\n\nact_scores = scores.Scores()\nfor obj in objs:\n    act_scores = act_scores.merge(obj)\nact_scores.df.head()\n\n\n\n\n\n\n\n\nlocation\nyear\npercent\nsection\nmean\ntest\n\n\n\n\n0\nUnited States\n2013\n51.731715\ncomposite\n20.9\nACT\n\n\n1\nAlabama\n2013\n78.000000\ncomposite\n20.4\nACT\n\n\n2\nAlaska\n2013\n37.000000\ncomposite\n21.1\nACT\n\n\n3\nArizona\n2013\n50.000000\ncomposite\n19.6\nACT\n\n\n4\nArkansas\n2013\n90.000000\ncomposite\n20.2\nACT\n\n\n\n\n\n\n\n\ndemonstration_locals = [\"Nebraska\",\n                        \"Massachusetts\", \"Florida\", \"United States\"]\n\n(states.merge(act_scores.get_section(\"composite\").get_year(2023).df,\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"mean\",\n       legend=True,\n       cmap=\"inferno\",\n       edgecolor=\"black\",\n       figsize=(8, 8),\n       lw=0.5,\n       legend_kwds={\"label\": \"Average SAT Score\",\n                    \"shrink\": 0.5}))\n\nplt.axis(\"off\")\nplt.title(\"Average ACT Score by State (2023)\")\nplt.show()\n\n\n\n\n\n\n\n\n\nact_scores_df = act_scores.get_section(\n    \"composite\").get_states(demonstration_locals).df\n\nsns.lineplot(data=act_scores_df,\n             x=\"year\",\n             y=\"mean\",\n             hue=\"location\",\n             marker=\"o\")\n\nplt.ylabel(\"Average ACT Score\")\nplt.xticks(range(act_scores_df[\"year\"].min(), act_scores_df[\"year\"].max()+1))\nplt.show()\n\n\n\n\n\n\n\n\n\n(states.merge(act_scores.get_section(\"composite\").get_year(2023).df,\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"percent\",\n       legend=True,\n       edgecolor=\"black\",\n       figsize=(8, 8),\n       lw=0.5,\n       legend_kwds={\"label\": \"Percentage of College Bound Seniors\", \"shrink\": 0.5}))\n\nplt.axis(\"off\")\nplt.title(\"Percentage of High Schoolers Participating in ACT by State (2023)\")\nplt.show()\n\n\n\n\n\n\n\n\n\nact_scores_df = act_scores.get_section(\"composite\").df\n\nanomaly.anomaly(act_scores_df, separate_years=False)\n\nact_corrected_scores = anomaly.anomaly(\n    act_scores_df, separate_years=True, suppress=True)\nplaw_scores = act_corrected_scores.assign(\n    anom_c=act_corrected_scores[\"mean\"]-act_corrected_scores[\"plaw_pred\"])\n\n\n\n\n\n\n\n\n\n(states.merge(plaw_scores.query(\"year==2023\"),\n              left_on=\"NAME\",\n              right_on=\"location\")\n .plot(column=\"anom_c\",\n       legend=True,\n       cmap=\"inferno\",\n       edgecolor=\"black\",\n       figsize=(8, 8),\n       lw=0.5,\n       legend_kwds={\"label\": \"Percentage Corrected ACT Performance\",\n                    \"shrink\": 0.5}))\n\nplt.axis(\"off\")\nplt.title(\"ACT Performance by State Corrected for Percentage Participation (2023)\")\nplt.show()\n\n\n\n\n\n\n\n\n\nsns.lineplot(data=plaw_scores.query(\"location in @demonstration_locals\"),\n             x=\"year\",\n             y=\"anom_c\",\n             hue=\"location\",\n             marker=\"o\")\n\nplt.legend(loc=\"center left\", bbox_to_anchor=(1, 0.5))\nplt.ylabel(\"ACT Performance Corrected for Percentage Participation\")\nplt.xticks(range(act_scores_df[\"year\"].min(), act_scores_df[\"year\"].max()+1))\nplt.show()\n\n\n\n\n\n\n\n\n\nrankings = plaw_scores.pivot_table(index=\"location\", columns=\"year\", values=\"anom_c\").sort_values(\n    2023, ascending=False).reset_index()\nrankings.columns.name = \"2023 Rankings\"\nrankings.index = rankings.index + 1\nrankings.round(1)\n\n\n\n\n\n\n\n2023 Rankings\nlocation\n2013\n2014\n2015\n2016\n2017\n2018\n2019\n2020\n2021\n2022\n2023\n\n\n\n\n1\nDistrict of Columbia\n-1.3\n-0.4\n-0.9\n0.3\n1.3\n1.0\n1.2\n1.0\n3.0\n4.6\n3.9\n\n\n2\nMassachusetts\n1.5\n1.4\n1.6\n1.8\n2.2\n2.3\n2.1\n2.2\n2.6\n2.5\n2.6\n\n\n3\nConnecticut\n1.7\n1.8\n1.9\n2.0\n2.2\n2.5\n2.2\n2.3\n2.8\n2.3\n2.6\n\n\n4\nIllinois\n0.4\n0.4\n0.5\n0.8\n1.2\n2.1\n2.2\n2.4\n2.6\n2.2\n2.3\n\n\n5\nNew York\n1.1\n0.8\n0.9\n1.0\n1.2\n1.5\n1.2\n1.4\n1.9\n1.6\n1.8\n\n\n6\nSouth Dakota\n1.3\n1.2\n1.2\n1.3\n1.3\n1.5\n1.4\n1.5\n1.3\n1.7\n1.5\n\n\n7\nMinnesota\n2.3\n2.2\n2.0\n1.1\n1.5\n1.5\n1.7\n1.7\n1.4\n1.5\n1.5\n\n\n8\nUtah\n0.5\n0.5\n-0.0\n0.2\n0.3\n0.6\n0.7\n0.8\n1.2\n0.9\n1.1\n\n\n9\nNew Jersey\n0.5\n0.4\n0.5\n0.4\n1.2\n1.0\n1.2\n1.3\n1.4\n1.3\n1.1\n\n\n10\nColorado\n0.2\n0.3\n0.5\n0.6\n0.8\n1.2\n1.0\n0.8\n0.6\n0.4\n1.0\n\n\n11\nIowa\n1.2\n1.1\n1.2\n1.2\n0.9\n1.1\n1.1\n0.8\n0.8\n1.2\n0.8\n\n\n12\nNorth Dakota\n0.2\n0.3\n0.4\n0.3\n0.3\n0.5\n0.2\n0.1\n0.4\n0.3\n0.8\n\n\n13\nVirginia\n0.3\n0.3\n0.4\n0.6\n0.6\n0.6\n0.6\n0.8\n1.1\n0.6\n0.8\n\n\n14\nWisconsin\n1.3\n1.4\n1.4\n0.5\n0.5\n0.7\n0.7\n0.7\n0.8\n0.5\n0.7\n\n\n15\nNebraska\n1.0\n1.2\n1.0\n1.1\n1.0\n0.3\n0.4\n0.5\n0.6\n0.5\n0.5\n\n\n16\nMissouri\n0.9\n1.1\n1.0\n0.2\n0.4\n0.2\n0.8\n0.7\n0.5\n0.6\n0.4\n\n\n17\nWyoming\n-0.4\n-0.2\n-0.0\n0.0\n0.2\n0.2\n0.2\n0.3\n0.5\n0.4\n0.4\n\n\n18\nMaryland\n-0.4\n-0.3\n-0.4\n-0.1\n0.3\n-0.2\n-0.4\n0.2\n0.9\n0.2\n0.4\n\n\n19\nMichigan\n-0.3\n-0.2\n-0.1\n0.3\n0.9\n0.8\n0.7\n0.7\n0.7\n0.4\n0.3\n\n\n20\nNew Hampshire\n1.0\n1.1\n1.0\n1.0\n0.9\n0.6\n0.5\n0.8\n0.2\n0.3\n0.3\n\n\n21\nKansas\n1.1\n1.2\n1.1\n1.2\n0.9\n1.0\n0.9\n0.5\n0.3\n0.5\n0.3\n\n\n22\nOhio\n1.1\n1.2\n1.2\n1.3\n1.3\n0.5\n0.4\n0.5\n0.1\n0.2\n0.2\n\n\n23\nGeorgia\n-0.6\n-0.6\n-0.3\n-0.0\n-0.1\n0.1\n0.2\n0.3\n0.5\n0.4\n0.2\n\n\n24\nCalifornia\n-0.1\n-0.1\n-0.2\n0.0\n-0.2\n-0.3\n-0.6\n-0.3\n0.3\n0.5\n0.2\n\n\n25\nMontana\n0.6\n0.2\n0.2\n0.3\n0.3\n0.2\n0.2\n0.5\n0.5\n0.4\n0.2\n\n\n26\nIdaho\n0.8\n0.8\n0.7\n0.5\n-0.1\n0.0\n0.1\n0.1\n-0.0\n0.0\n0.1\n\n\n27\nKentucky\n-0.6\n-0.4\n-0.2\n0.0\n0.0\n0.4\n0.2\n0.1\n0.0\n-0.3\n0.1\n\n\n28\nWashington\n0.1\n0.1\n-0.7\n-0.2\n-1.3\n-1.1\n-1.0\n-0.6\n-1.4\n0.0\n0.0\n\n\n29\nArkansas\n-0.2\n0.0\n0.0\n0.1\n-0.6\n-0.4\n-0.3\n-0.4\n-0.2\n-0.1\n-0.1\n\n\n30\nTennessee\n-0.7\n-0.5\n-0.4\n-0.1\n-0.2\n-0.2\n-0.2\n-0.1\n-0.1\n-0.2\n-0.2\n\n\n31\nNorth Carolina\n-1.5\n-1.4\n-1.2\n-0.9\n-0.9\n-0.7\n-0.6\n-0.6\n-0.4\n-0.5\n-0.3\n\n\n32\nLouisiana\n-0.7\n-1.1\n-0.8\n-0.5\n-0.5\n-0.6\n-0.8\n-0.7\n-0.8\n-0.7\n-0.4\n\n\n33\nRhode Island\n-0.6\n-0.7\n-0.6\n-0.6\n-0.1\n-0.5\n-0.3\n-0.4\n-0.6\n-0.2\n-0.4\n\n\n34\nPennsylvania\n-0.2\n-0.5\n-0.5\n-0.4\n-0.1\n-0.3\n-0.4\n-0.6\n0.0\n-0.2\n-0.6\n\n\n35\nAlabama\n-0.2\n-0.0\n-1.1\n-0.9\n-0.8\n-0.7\n-0.7\n-0.6\n-0.5\n-0.8\n-0.6\n\n\n36\nDelaware\n-0.3\n-0.1\n0.0\n-0.1\n-0.5\n-0.5\n-0.7\n-1.0\n-0.1\n-0.5\n-0.7\n\n\n37\nOklahoma\n0.1\n-0.1\n0.1\n-0.0\n-0.6\n-0.5\n-0.7\n-0.7\n-0.5\n-1.0\n-0.8\n\n\n38\nVermont\n0.7\n0.8\n0.8\n0.5\n0.4\n0.8\n0.6\n0.2\n-1.7\n-0.5\n-0.9\n\n\n39\nIndiana\n-0.0\n0.0\n0.1\n0.2\n-0.1\n-0.1\n-0.1\n-0.3\n-0.2\n-0.3\n-0.9\n\n\n40\nWest Virginia\n-0.3\n-0.4\n-0.2\n-0.2\n-0.5\n-0.5\n-0.4\n-0.9\n-0.8\n-0.9\n-0.9\n\n\n41\nArizona\n-1.7\n-1.6\n-1.5\n-1.1\n-1.5\n-1.6\n-1.3\n-1.1\n-1.5\n-1.2\n-0.9\n\n\n42\nUnited States\n-0.3\n-0.4\n-0.4\n-0.4\n-0.4\n-0.6\n-0.6\n-0.6\n-1.0\n-1.0\n-1.0\n\n\n43\nMississippi\n-1.4\n-1.3\n-1.2\n-1.6\n-1.4\n-1.2\n-1.2\n-1.2\n-1.1\n-1.0\n-1.0\n\n\n44\nFlorida\n-1.1\n-1.0\n-0.8\n-0.6\n-1.0\n-0.9\n-0.9\n-0.7\n-0.9\n-1.3\n-1.2\n\n\n45\nNevada\n-0.7\n-0.8\n-1.1\n-2.3\n-2.2\n-2.1\n-1.7\n-1.5\n-1.4\n-1.5\n-1.4\n\n\n46\nHawaii\n-1.5\n-2.3\n-1.9\n-1.4\n-1.2\n-1.2\n-1.1\n-1.4\n-1.7\n-1.2\n-1.5\n\n\n47\nSouth Carolina\n-0.9\n-0.8\n-0.8\n-1.5\n-1.3\n-1.5\n-1.3\n-1.6\n-1.9\n-1.7\n-1.5\n\n\n48\nOregon\n-0.4\n-0.6\n-0.7\n-0.5\n-0.5\n-0.6\n-0.5\n-0.5\n-1.9\n-1.6\n-1.8\n\n\n49\nTexas\n-0.9\n-1.0\n-1.1\n-1.2\n-1.3\n-1.3\n-1.3\n-1.6\n-2.1\n-2.1\n-2.2\n\n\n50\nAlaska\n-0.7\n-1.0\n-1.0\n-1.4\n-1.2\n-1.7\n-1.8\n-2.0\n-2.4\n-2.5\n-2.2\n\n\n51\nNew Mexico\n-0.9\n-1.0\n-0.8\n-0.9\n-1.3\n-1.3\n-1.3\n-1.5\n-1.5\n-2.3\n-2.3\n\n\n52\nMaine\n-0.8\n-1.1\n-1.0\n-2.2\n-2.8\n-2.9\n-2.7\n-2.8\n-2.7\n-2.8\n-2.5\n\n\n\n\n\n\n\n\nanomaly.anomaly(act_scores_df, separate_years=True)\n\n\n\n\n\n\n\n\nlocation\nyear\npercent\nsection\nmean\ntest\nlin_pred\nplaw_pred\n\n\n\n\n0\nUnited States\n2013\n51.731715\ncomposite\n20.9\nACT\n21.558710\n21.232126\n\n\n1\nAlabama\n2013\n78.000000\ncomposite\n20.4\nACT\n20.683361\n20.610784\n\n\n2\nAlaska\n2013\n37.000000\ncomposite\n21.1\nACT\n22.049621\n21.753109\n\n\n3\nArizona\n2013\n50.000000\ncomposite\n19.6\nACT\n21.616417\n21.284478\n\n\n4\nArkansas\n2013\n90.000000\ncomposite\n20.2\nACT\n20.283479\n20.398556\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n99\nVirginia\n2023\n8.000000\ncomposite\n24.6\nACT\n23.716262\n23.806714\n\n\n100\nWashington\n2023\n6.000000\ncomposite\n24.5\nACT\n23.840851\n24.486780\n\n\n101\nWest Virginia\n2023\n26.000000\ncomposite\n20.3\nACT\n22.594961\n21.212074\n\n\n102\nWisconsin\n2023\n95.000000\ncomposite\n19.4\nACT\n18.296643\n18.684723\n\n\n103\nWyoming\n2023\n100.000000\ncomposite\n19.0\nACT\n17.985171\n18.591125\n\n\n\n\n624 rows × 8 columns"
  }
]